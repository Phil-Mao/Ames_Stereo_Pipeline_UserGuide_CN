# 1. 绪论
NASA的``ASP``是一款免费且开源的自动大地测量和立体测量工具，用于处理从卫星（围绕地球或其他星球）、机器人漫游车、航空相机获取到的立体影像，以及是否具有准确相机姿态信息的历史影像。它提供多种制图产品，包括数字地形模型(DTM)，数字正射影像(DOM)，3D模型以及相机网络束的调整。ASP的数据产品适合用于科学分析，任务计划以及公众宣传。  
<div style="text-align:center;">

![Figure1.1](/imgs/Fig1.1.png)  
</div>    

图1.1 该3D模型是由影像对``M01/00115``和``E02/01461(北纬34.66，东经141.29)``生成。输入一张大小为``1024x8064``的影像，整个立体重建过程在一台3.0GHz的工作站上大约花了三十分钟。此处的模型在垂直方向上并没有夸大显示，横轨的尺寸大约是2公里。  

## 1.1 背景  
十多年来，NASA ``AMES``研究中心的智能机器人技术小组(IRG)致力于为行星探索开发3D表面重建和可视化功能。IRG首次在火星探路者任务中进行了演示，为MPL任务、MER任务、MRO任务和LRO任务的科学操作团队提供了这些功能。而实现这些工作的一个关键组件技术就是ASP。立体管线能够利用立体像对生产高质量、密集的、带有纹理映射的三维表面模型。此外，ASP提供了执行许多其他制图任务的工具，包括地图投影，点云和DEM注册，相机的自动注册，数据格式转换和数据可视化。 

尽管最初是为地面控制和科学可视化应用而开发的，ASP已发展为解决轨道立体测量和制图应用。尤其是远程计划需要对行星地形有详细的了解，而高分辨率地形数据通常是从轨道获取的立体像对中得到的。轨道测绘卫星先于着陆器和火星车被发送到行星体上。他们向地面返回了大量的图像和其他数据，可帮助任务规划者和科学家确定能够值得进一步研究的领域。地形信息通常在这些规划和分析过程中发挥着核心作用。  

我们近段时间开发的立体管线与NASA轨道测绘任务返回的数据数量级比以往任何时候都多的时间相吻合。火星和月球侦察轨道飞行器任务的数据量现在以几十兆节为单位。如今达到的共识是目前的处理技术仍然非常耗费人力和物力，不再满足NASA和行星科学界对数据处理的需求。举一个与此相关的例子，HiRISE已获取了几千对立体像对。然而，目前只有大约两百对立体像对被处理过，主要是靠人工操作的高端摄影测量工作站。很明显，如果能够开发一种更精简、更有效的流程，就可以从这些有价值的原始数据中提取更多的价值。  

立体管线的设计就是为了满足这一需求。通过应用计算机视觉领域最新的进展，我们已经创建了一个能够在最少人工干预的情况下生成高质量DTM的自动化过程。立体管线的用户在第一次开始处理一种新类型的影像时，需要花一定的时间来进行少量的设置。一旦设置完，立体管线就可以不用进一步调整设置，并且可以处理数十、数百、数千对立体像对。随着该软件的发布，我们希望鼓励运行和支持这些遥感任务的机构采用该工具链。在不久的将来，我们希望看到该工具与其他自动影像处理管线一起被并入地面数据处理系统。随着该工具的不断成熟，我们相信，它能够在不需要任何人工干预的情况下生成高质量的数字高程模型。  
## 1.2 人类与计算机：何时选择自动化？  
什么时候选择自动的立体测绘而不是使用传统的、人工操作的摄影测量工作站是合适的？这是一个哲学问题，随着自动化数据处理技术变得更加强大和广泛使用，这个答案在未来几年可能会有所改变。到目前为止，我们认为您应该始终依靠人工主导的手动数据处理技术，为那些人类生命或可观的资本资源处于危险中的任务生产关键数据产品。特别是用于着陆点分析和精确着陆的地图毫无疑问需要专业的操作员来消除DEM中明显的错误，并确保已遵循正确的程序来纠正卫星遥测误差，以使数据具有最佳的大地测量控制能力。  

当使用DTM进行科学分析时，两种技术各有优点。人工主导的立体重建生产的DTM得益于专家的直觉和经验，因此具很高的质量。构建和验证这些DTM的过程已经在科学界得到了较好的认可和接受。

但是，只有有限数量的DTM能够被处理到这种质量水平。其余的，可以使用自动立体处理来制作DTM，而它们的成本仅为一小部分。它们结果的准确性并不一定低于人工操作制作的，但是它们不会从同样的审查和质量控制中受益。因此，这些DTM的用户必须能够识别潜在的问题，并注意由于不当使用这些工具而导致的错误。

我们建议所有立体管线的用户花些时间认真阅读这篇文档，知道如何将立体重建和光束调整最佳的结合使用以产生高质量的结果。如果你有任何问题欢迎联系我们。[(1.4 节)](#1.4)

## 1.3 软件基础
### 1.3.1 NASA 视觉工作平台
立体管线是基于视觉工作平台软件建立的，这同样是<a href ="https://ti.arc.nasa.gov/tech/asr/groups/intelligent-robotics/">IRG</a>开发的一个通用图像处理软件和计算机视觉库。本文档中讨论的某些工具实际上是视觉工作平台中的程序，立体管线发行的任何版本都需要依赖视觉工作平台。只有在编译这个软件时，这个区别才尤为重要。
### 1.3.2 USGS成像仪和光谱仪集成软件
为了处理非地面NASA卫星影像，必须在用于成像仪和光谱仪的集成软件<a href ="https://isis.astrogeology.usgs.gov/">(ISIS)</a>副本中安装立体管线。但处理地面影像不需要ISIS(DigitalGlobe/Maxar WorldView, ect)  

ISIS被广泛应用于行星科学界，用于将原始航天器影像处理成具有科学感兴趣的高水平数据产品，例如地图投影图像和镶嵌图像[USGS09, AndersonSidesSoltesz+04, GaddisAndersonBecker+97]。我们选择ISIS有以下几个原因：(1)它被行星科学界广泛采用；(2)它包含用于行星遥感仪器的几何相机模型的权威集合；(3)它是很容易利用的开源软件。  

通过安装立体管线，你可以在现有ISIS工作流程中添加使用高级立体图像处理功能。立体管线支持ISIS中的cube(``.cub``)文件格式，并且可以利用在许多NASA航天器上成像器的相机模型和辅助信息（例如，SPICE kernels）。使用这套单一标准化的相机模型，可以确保立体管线和ISIS生成的产品之间的一致性。同样，通过利用ISIS的相机模型，立体管线可以处理几乎任何NASA任务获取的立体像对。
## 1.4 获取帮助和报告错误
所有的错误，功能需求和讨论都应刚发布在ASP支持的论坛上：  
https://groups.google.com/forum/#!forum/ames-stereo-pipeline-support  
 直接联系开发人员和项目管理者，发送邮件到：
stereo-pipeline-owner@lists.nasa.gov  
提交错误报告时，附加``stereo``和其他工具输出的日志可能会有所帮助。
## 1.5 排版约定
旨在命令行上运行的程序名称以等宽的字体编写，比如``stereo``程序，以及那些程序的选项。 

可以在终端中输入缩进的等宽文本行，这些行将以">"表示常规的Shell，或者以"ISIS>"表示启用ISIS的Shell程序(这意味着你必须设置``ISISROOT``环境变量，并以获取适当的ISIS启动脚本，如ISIS说明所述)。  
```
>ls  

ISIS> pds2isis
```  
用大于号和小于号括起来的等宽文本表示用户需要提供的选项或参数。例如，``‘stereo E0201461.map.cub M0100115.map.cub out’``是特定的，但是``‘stereo <left-image> <right-image> out’``表示不是``<left-image>``和``<right-image>``特定文件的名称，需要用实际文件名替换虚拟参数。  

方括号表示命令的可选选项或值，用竖线分隔的项目是彼此的别名，或者是不同的特定选项。默认参数或其他注释用括号括起来，并在行的后面加上反斜杠：  
``` 
point2dem [-h|--help] [-r moon|mars] [-s <float(default: 0.0)>] \
          [-o <output-filename>] <pointcloud>-PC.tif  
```  
上面是在运行``point2dem``程序。它需要的唯一参数是点云文件，该文件是由``stereo``程序生成的并以``-PC.tif``结尾，文件前缀可以任意指定(就是大于号和小于号内的内容)。其他所有内容都用方括号表示，表明它们是可选的。  

``-help``和``-h``是相同的。同样，``-r``选项的参数必须是``moon``或者``mars``。``-s``选项将浮点值作为其参数，并且默认值是零。``-o``选项是输出DTM的文件名。  

尽管有两行等宽文本，但第一行末尾的反斜杠表示命令在第二行继续运行。你可以在终端输入任意长度的内容，可以用反斜杠和回车键继续在第二行输入。 
## 1.6 在你的工作中引用ASP参考
……
## 1.7 ASP用户警告
……